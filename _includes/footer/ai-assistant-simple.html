<!-- AI Assistant Button and Chat Interface - Working Version -->
<style>
  /* AI Assistant Container */
  #ai-assistant-wrapper {
    position: fixed;
    bottom: 30px;
    right: 30px;
    z-index: 999999;
    animation: float 3s ease-in-out infinite;
  }
  
  @keyframes float {
    0% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
    100% { transform: translateY(0px); }
  }
  
  #ai-assistant-trigger {
    background: linear-gradient(135deg, #1e40af 0%, #7c3aed 100%);
    border: none;
    border-radius: 50px;
    padding: 16px 32px;
    color: white;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
    display: flex;
    align-items: center;
    gap: 12px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  #ai-assistant-trigger:hover {
    transform: scale(1.08);
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.35);
  }
  
  #ai-assistant-wrapper:hover {
    animation-play-state: paused;
  }
  
  #ai-chat-window {
    position: fixed;
    bottom: 120px;
    right: 30px;
    width: 450px;
    height: 600px;
    background: white;
    border-radius: 16px;
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
    display: none;
    flex-direction: column;
    overflow: hidden;
    z-index: 999999;
  }
  
  #ai-chat-header {
    background: linear-gradient(135deg, #1e40af 0%, #7c3aed 100%);
    color: white;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  #ai-chat-header h3 {
    margin: 0;
    font-size: 18px;
  }
  
  #ai-chat-close {
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  #ai-chat-close:hover {
    background: rgba(255, 255, 255, 0.2);
  }
  
  #ai-chat-frame {
    flex: 1;
    border: none;
    width: 100%;
  }
  
  @media (max-width: 768px) {
    #ai-assistant-wrapper {
      bottom: 20px;
      right: 20px;
    }
    
    #ai-assistant-trigger {
      padding: 12px 24px;
      font-size: 14px;
    }
    
    #ai-chat-window {
      bottom: 100px;
      right: 20px;
      width: calc(100vw - 40px);
      max-width: 400px;
      height: 70vh;
      max-height: 600px;
    }
  }
</style>

<div id="ai-assistant-wrapper">
  <button id="ai-assistant-trigger">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 2C10.9 2 10 2.9 10 4C10 5.1 10.9 6 12 6C13.1 6 14 5.1 14 4C14 2.9 13.1 2 12 2ZM12 8C9.79 8 8 9.79 8 12C8 14.21 9.79 16 12 16C14.21 16 16 14.21 16 12C16 9.79 14.21 8 12 8ZM12 18C10.9 18 10 18.9 10 20C10 21.1 10.9 22 12 22C13.1 22 14 21.1 14 20C14 18.9 13.1 18 12 18ZM6 12C6 10.9 5.1 10 4 10C2.9 10 2 10.9 2 12C2 13.1 2.9 14 4 14C5.1 14 6 13.1 6 12ZM20 10C18.9 10 18 10.9 18 12C18 13.1 18.9 14 20 14C21.1 14 22 13.1 22 12C22 10.9 21.1 10 20 10ZM17.66 4.34C16.88 3.56 15.61 3.56 14.83 4.34C14.05 5.12 14.05 6.39 14.83 7.17C15.61 7.95 16.88 7.95 17.66 7.17C18.44 6.39 18.44 5.12 17.66 4.34ZM7.17 14.83C6.39 14.05 5.12 14.05 4.34 14.83C3.56 15.61 3.56 16.88 4.34 17.66C5.12 18.44 6.39 18.44 7.17 17.66C7.95 16.88 7.95 15.61 7.17 14.83ZM19.66 14.83C18.88 14.05 17.61 14.05 16.83 14.83C16.05 15.61 16.05 16.88 16.83 17.66C17.61 18.44 18.88 18.44 19.66 17.66C20.44 16.88 20.44 15.61 19.66 14.83ZM7.17 7.17C7.95 6.39 7.95 5.12 7.17 4.34C6.39 3.56 5.12 3.56 4.34 4.34C3.56 5.12 3.56 6.39 4.34 7.17C5.12 7.95 6.39 7.95 7.17 7.17Z" fill="currentColor"/>
    </svg>
    <span>Ask about my research</span>
  </button>
</div>

<div id="ai-chat-window">
  <div id="ai-chat-header">
    <h3>David's Research Assistant</h3>
    <button id="ai-chat-close">&times;</button>
  </div>
  <iframe 
    id="ai-chat-frame"
    src="https://dvdijcke-david-research-assistant.hf.space"
    title="AI Research Assistant">
  </iframe>
</div>

<script>
// Wait for everything to be ready
window.addEventListener('load', function() {
  setTimeout(function() {
    var triggerBtn = document.getElementById('ai-assistant-trigger');
    var closeBtn = document.getElementById('ai-chat-close');
    var chatWindow = document.getElementById('ai-chat-window');
    var wrapper = document.getElementById('ai-assistant-wrapper');
    
    if (triggerBtn) {
      triggerBtn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        if (chatWindow) chatWindow.style.display = 'flex';
        if (wrapper) wrapper.style.display = 'none';
      });
    }
    
    if (closeBtn) {
      closeBtn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        if (chatWindow) chatWindow.style.display = 'none';
        if (wrapper) wrapper.style.display = 'block';
      });
    }
    
    // Close on outside click
    document.addEventListener('click', function(event) {
      if (chatWindow && chatWindow.style.display === 'flex') {
        if (!chatWindow.contains(event.target) && !wrapper.contains(event.target)) {
          chatWindow.style.display = 'none';
          wrapper.style.display = 'block';
        }
      }
    });
    
    // Prevent clicks inside chat window from closing it
    if (chatWindow) {
      chatWindow.addEventListener('click', function(event) {
        event.stopPropagation();
      });
    }
  }, 100); // Small delay to ensure everything is rendered
});
</script>